#include <gtest/gtest.h>

#include <ais/AddressedSafetyMessage.h>

// !AIVDM,4,1,1,B,<@3OwTAGU`QhI?EBP1B5P1@@B?1389>7PD85P45<1G1,0*7A,d-068,S0943,t012825.00,T25.16331961,r05RCPM1,1360718905
// !AIVDM,4,2,1,B,B5P21IPC51C?>1<P=1>175=5>DP1B51P6?BP5>41>75,0*5A,d-068,S0943,t012825.00,T25.16331961,r05RCPM1,1360718905
// !AIVDM,4,3,1,B,B54PB978DPG81<5fP1Pih;DPC@554PB5CDB93D9?>P6,0*1B,d-068,S0943,t012825.00,T25.16331961,r05RCPM1,1360718905
// !AIVDM,4,4,1,B,?BP1<<PF5CC5<CPnm6DP?BP<?>75B0,2*72,d-068,S0943,t012825.00,T25.16331961,r05RCPM1,1360718905
// retransmitted False
// seq_num 0
// dest_mmsi 367370780
// text YOUR ARE APPROACHING THE DELAWARE BAY SEASONAL MANAGEMENT AREA FOR ENDANGERED RIGHT WHALE. A 10KT SPEED RESTRICTION FOR ALL VESSELS 65FT OR LONGER@
// mmsi 3669905
// repeat_indicator 1
// spare 0
// id 12

TEST(TestAddressedSafetyMessage, AisMsg12) {
    ais::BinaryPayload bp("<@3OwTAGU`QhI?EBP1B5P1@@B?1389>7PD85P45<1G1B5P21IPC51C?>1<P=1>175=5>DP1B51P6?BP5>41>75B54PB978DPG81<5fP1Pih;DPC@554PB5CDB93D9?>P6?BP1<<PF5CC5<CPnm6DP?BP<?>75B0",2);
    ais::AddressedSafetyMessage m(bp);
    
    ASSERT_EQ(12,m.message_id);
    ASSERT_EQ(1,m.repeat_indicator);
    ASSERT_EQ(3669905,m.mmsi);
    
    ASSERT_EQ(0, m.seq);
    ASSERT_EQ(367370780, m.dest_mmsi);
    ASSERT_FALSE(m.retransmit);
    ASSERT_EQ(0, m.spare);
    ASSERT_EQ("YOUR ARE APPROACHING THE DELAWARE BAY SEASONAL MANAGEMENT AREA FOR ENDANGERED RIGHT WHALE. A 10KT SPEED RESTRICTION FOR ALL VESSELS 65FT OR LONGER",m.text);
}

// !AIVDM,4,1,0,B,<@3OwTAGOc40I?EWB5P9>PD85P45<1G1B5P21IPC=1P,0*48,d-098,S1568,t014441.00,T41.82994455,r05RCHI1,1360719883
// !AIVDM,4,2,0,B,6?BPD85P5>41>75B54PB978DPG81<5P1>4P=1IP25P5,0*5B,d-098,S1568,t014441.00,T41.82994455,r05RCHI1,1360719883
// !AIVDM,4,3,0,B,H35549>7PD85Pih;DCPC@554PB5CDB93D9?>fP@<51C,0*67,d-098,S1568,t014441.00,T41.82994455,r05RCHI1,1360719883
// !AIVDM,4,4,0,B,5PC<?GPD?Pih;DCf0,4*63,d-098,S1568,t014441.00,T41.82994455,r05RCHI1,1360719883
// retransmitted False
// seq_num 0
// dest_mmsi 366980160
// text YOU`RE IN THE DELAWARE BAY SMA FOR THE ENDANGERED RIGHT WHALE AND MAY BE EXCEEDING THE 10KTS SPEED RESTRICTION. PLEASE SLOW TO 10KTS.@
// mmsi 3669905
// repeat_indicator 1
// spare 0
// id 12

TEST(TestAddressedSafetyMessage, AisMsg12Speeding) {
    ais::BinaryPayload bp("<@3OwTAGOc40I?EWB5P9>PD85P45<1G1B5P21IPC=1P6?BPD85P5>41>75B54PB978DPG81<5P1>4P=1IP25P5H35549>7PD85Pih;DCPC@554PB5CDB93D9?>fP@<51C5PC<?GPD?Pih;DCf0",4);
    ais::AddressedSafetyMessage m(bp);

    ASSERT_EQ(12,m.message_id);
    ASSERT_EQ(1,m.repeat_indicator);
    ASSERT_EQ(3669905,m.mmsi);
    
    ASSERT_EQ(0, m.seq);
    ASSERT_EQ(366980160, m.dest_mmsi);
    ASSERT_FALSE(m.retransmit);
    ASSERT_EQ(0, m.spare);
    ASSERT_EQ("YOU'RE IN THE DELAWARE BAY SMA FOR THE ENDANGERED RIGHT WHALE AND MAY BE EXCEEDING THE 10KTS SPEED RESTRICTION. PLEASE SLOW TO 10KTS.",m.text);
}
